"use strict";var faceRecog={};(function(e,c,f,k,m){var d="";var o="";var t;var s="";var g={width:300,height:300,interval:1000,timeOut:120};var u={};var j=0;var b=0;var h=function(y){var C=y.toString().replace(/[\s\?]*/g,""),x=C.length>=50?50:C.length;C=C.substring(0,x);var w=C.match(/^function([^\(]+?)\(/);if(w&&w[1]){return w[1]}var v=y.caller,A=v.toString().replace(/[\s\?]*/g,"");var z=A.indexOf(C),B=A.substring(z-30,z);w=B.match(/var([^\=]+?)\=/);if(w&&w[1]){return w[1]}return"anonymous"};var l=function(){if(t){i()}u={};d="";o="";s=""};var q=function(v){u={};u=c.extend({},v,g);if(v.width){u.width=v.width}if(v.height){u.height=v.height}if(v.interval){u.interval=v.interval}if(v.timeOut){u.timeOut=v.timeOut}};var i=function(){f.clearInterval(t);t=undefined;j=0;b=0};var a=function(){if(t){var v=new Date().getTime();if(v>=b){console.log("结束轮询认证结果, 共执行["+(v-j)+"]毫秒");i()}}};var n=function(x){var w=u.context+"/facerecog/getFaceRecogResult";var v={};c.ajax({url:w,data:{bizNo:x},type:"get",async:false,success:function(y){v=y;console.log("biz_no=["+x+"]的认证结果如下:");console.log(v)},error:function(y){console.log(y)}});return v};e.checkIdNo=function(x){q(x);var w=u.context+"/facerecog/checkCertNo";var v={};c.ajax({url:w,type:"post",async:true,data:{idNo:x.idNo,tranCode:x.tranCode},success:function(y){v=y;x.callBack.apply(null,[v,u])},error:function(y){console.log(y)}})};e.getRecogResult=function(w){var v=n(w);return v};e.lxRecogResult=function(){a();var v=n(s);if("true"===v.passed){if(t){i()}u.callBack2.apply(null,[v])}else{if(u.alwaysExecute===true){u.callBack2.apply(null,[v])}else{if(!t){v.timeOutFlag=true;u.callBack2.apply(null,[v,u])}}}};var r=function(v,x){var w=c("#"+v);w.attr("src","data:image/png;base64,"+x)};var p=function(){j=new Date().getTime();b=j+u.timeOut*1000;console.log("开始轮询认证结果, startTime=["+j+"], endTime=["+b+"]");t=f.setInterval("faceRecog.lxRecogResult()",u.interval)};e.generateQrCode=function(x){l();var w={};q(x);var v=u.context+"/facerecog/getFaceRecogQrcode";var y=c.extend({},u,{});y.callBack1=undefined;y.callBack2=undefined;c.ajax({url:v,type:"post",async:true,data:y,success:function(z){w=z;if(w.biz_no){s=w.biz_no;if(u.imgId&&typeof u.imgId==="string"){r(u.imgId,w.qrcode)}if(true===u.cycleQuery&&u.callBack2&&typeof u.callBack2==="function"){p()}}u.callBack1.apply(null,[w,u])},error:function(z){console.log(z)}})}})(faceRecog,jQuery,window,document,undefined);